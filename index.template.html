<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">
  <title>Maze Generator</title>
  <script defer src="bundle.js"></script>
  <style>
    canvas {
      width: 100%;
      image-rendering: pixelated;
    }
    
    /* Sidebar Toggle Styles */
    .sidebar-toggle {
      position: fixed;
      top: 20px;
      left: 20px;
      z-index: 1050;
      background: #0d6efd;
      border: none;
      color: white;
      width: 40px;
      height: 40px;
      border-radius: 6px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    
    .sidebar-toggle:hover {
      background: #0b5ed7;
      transform: scale(1.05);
    }
    
    .sidebar-toggle .hamburger {
      width: 20px;
      height: 2px;
      background: white;
      position: relative;
      transition: all 0.3s ease;
    }
    
    .sidebar-toggle .hamburger::before,
    .sidebar-toggle .hamburger::after {
      content: '';
      position: absolute;
      width: 20px;
      height: 2px;
      background: white;
      transition: all 0.3s ease;
    }
    
    .sidebar-toggle .hamburger::before {
      top: -6px;
    }
    
    .sidebar-toggle .hamburger::after {
      top: 6px;
    }
    
    .sidebar-toggle.active .hamburger {
      background: transparent;
    }
    
    .sidebar-toggle.active .hamburger::before {
      transform: rotate(45deg);
      top: 0;
    }
    
    .sidebar-toggle.active .hamburger::after {
      transform: rotate(-45deg);
      top: 0;
    }
    
    .sidebar-container {
      position: fixed;
      top: 0;
      left: 0;
      height: 100vh;
      width: 350px;
      background: white;
      z-index: 1040;
      transition: transform 0.3s ease;
      box-shadow: 2px 0 10px rgba(0,0,0,0.1);
      overflow-y: auto;
      padding-top: 80px;
      padding-left: 15px;
      padding-right: 15px;
    }
    
    .sidebar-container.collapsed {
      transform: translateX(-320px);
    }
    
    .main-content {
      margin-left: 350px;
      transition: margin-left 0.3s ease;
      min-height: 100vh;
    }
    
    .main-content.expanded {
      margin-left: 30px;
    }
    
    .sidebar-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      z-index: 1030;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }
    
    .sidebar-overlay.show {
      opacity: 1;
      visibility: visible;
    }
    
    /* Media queries for responsive behavior */
    @media (max-width: 992px) {
      .sidebar-container {
        width: 300px;
      }
      
      .sidebar-container.collapsed {
        transform: translateX(-270px);
      }
      
      .main-content {
        margin-left: 0;
      }
      
      .main-content.expanded {
        margin-left: 0;
      }
    }
    

    
    .maze-grid {
      display: inline-block;
      border: 2px solid #333;
      background: #333;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      border-radius: 4px;
    }
    
    .maze-container {
      display: flex;
      gap: 20px;
      margin-top: 20px;
      min-height: 600px;
    }
    
    /* Hide default number input spinners */
    input[type=number]::-webkit-outer-spin-button,
    input[type=number]::-webkit-inner-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }
    
    /* For Firefox */
    input[type=number] {
      -moz-appearance: textfield;
    }
    
    /* Custom number input styling */
    .number-input-group {
      display: flex;
      width: 100%;
    }
    
    .number-input-group input {
      text-align: center;
      border-left: 0;
      border-right: 0;
      z-index: 2;
      position: relative;
    }
    
    .number-input-group input:focus {
      z-index: 3;
      box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);
      border-color: #86b7fe;
    }
    
    .number-btn {
      width: 45px;
      height: 38px;
      padding: 0;
      font-size: 16px;
      font-weight: bold;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 1px solid #ced4da;
      background: #f8f9fa;
      color: #495057;
      cursor: pointer;
      transition: all 0.15s ease-in-out;
      user-select: none;
    }
    
    .number-btn:hover {
      background: #e9ecef;
      border-color: #adb5bd;
      color: #212529;
    }
    
    .number-btn:active {
      background: #dee2e6;
      border-color: #6c757d;
      transform: translateY(1px);
    }
    
    .number-btn.disabled {
      opacity: 0.4;
      cursor: not-allowed;
      pointer-events: none;
    }
    
    .number-btn-minus {
      border-top-left-radius: 0.375rem;
      border-bottom-left-radius: 0.375rem;
      border-right: 0;
    }
    
    .number-btn-plus {
      border-top-right-radius: 0.375rem;
      border-bottom-right-radius: 0.375rem;
      border-left: 0;
    }
    
    .maze-row {
      display: flex;
      height: auto;
    }
    
    .maze-cell {
      width: 20px;
      height: 20px;
      border: 1px solid #666;
      position: relative;
      flex-shrink: 0;
      box-sizing: border-box;
      display: inline-block;
    }
    
    .maze-indicator {
      width: 20px;
      height: 10px;
    }
    
    /* Remove media queries - let JavaScript handle dynamic sizing */
    
    .maze-cell.wall {
      background: #777;
      border: 1px solid #aaa;
    }
    
    .maze-cell.path {
      background: white;
      border: 1px solid #ddd;
    }
    
    .maze-indicator.horizontal {
      background: white;
    }
    
    .maze-indicator.up {
      background: #ff7;
    }
    
    .maze-indicator.down {
      background: #7ff;
    }
    
    /* Exact block layout styles */
    .exact-maze-cell {
      width: 20px;
      height: 20px;
      border: 1px solid #666;
      box-sizing: border-box;
      flex-shrink: 0;
    }
    
    .exact-path {
      background: white;
    }
    
    .exact-border-wall {
      background: #555;
    }
    
    .exact-vertical-wall {
      background: #777;
    }
    
    .exact-horizontal-wall {
      background: #777;
    }
    
    .exact-wall-pillar {
      background: #999;
    }
    
    .exact-entrance {
      background: #90EE90;
    }
    
    .exact-exit {
      background: #FFB6C1;
    }
    
    .exact-hole-up-ladder {
      background: #ffff00;
    }
    
    .exact-hole-down-ladder {
      background: #87ceeb;
    }
    
    .exact-hole-up-only {
      background: #ffaaaa;
    }
    
    .exact-hole-down-only {
      background: #aaaaff;
    }
    
    .exact-unknown {
      background: #ff0000;
    }
    
    /* Enhanced ladder placement indicators */
    .ladder-solid-wall {
      background: #ffff00;
      border: 2px solid #ffaa00;
    }
    
    .ladder-corner {
      background: #87ceeb;
      border: 2px solid #4682b4;
    }
    
    .ladder-wall-creation {
      background: #98fb98;
      border: 2px solid #32cd32;
    }
    
    .ladder-ceiling {
      background: #dda0dd;
      border: 2px solid #9932cc;
    }
    
    /* Tooltip styles */
    .cell-tooltip {
      position: absolute;
      background: rgba(0, 0, 0, 0.9);
      color: white;
      padding: 8px 12px;
      border-radius: 4px;
      font-size: 12px;
      z-index: 1000;
      pointer-events: none;
      white-space: nowrap;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
      max-width: 250px;
    }
    
    .cell-tooltip::after {
      content: '';
      position: absolute;
      top: 100%;
      left: 50%;
      margin-left: -5px;
      border-width: 5px;
      border-style: solid;
      border-color: rgba(0, 0, 0, 0.9) transparent transparent transparent;
    }
    
    .display-toggle {
      margin-bottom: 15px;
    }
    
    .display-toggle button {
      margin-right: 10px;
    }
    
    .display-toggle button.active {
      background-color: #0d6efd;
      color: white;
      border-color: #0d6efd;
    }
  </style>
</head>

<body>
  <!-- Sidebar Toggle Button -->
  <button class="sidebar-toggle" id="sidebarToggle">
    <div class="hamburger"></div>
  </button>
  
  <!-- Sidebar Overlay for mobile -->
  <div class="sidebar-overlay" id="sidebarOverlay"></div>
  
  <!-- Sidebar Container -->
  <div class="sidebar-container" id="sidebarContainer">
    <!-- Version -->
    <div class="mb-3">
      <small class="text-muted">Version: {{VERSION}}</small>
    </div>
    
    <!-- Show/Hide All Toggle -->
    <div class="mb-3">
      <button class="btn btn-outline-primary btn-sm w-100" id="toggleAllBtn">Show All</button>
    </div>
    
    <!-- Maze Generation Buttons -->
    <div class="card mb-3">
      <div class="card-header" data-bs-toggle="collapse" data-bs-target="#collapseGenBtns" aria-expanded="true" style="cursor:pointer;">
        Maze Generation Buttons
      </div>
      <div id="collapseGenBtns" class="collapse show">
        <div class="card-body">
          <div class="d-grid gap-2">
            <button class="btn btn-info" id="refreshBtn">Refresh Maze View</button>
            <button class="btn btn-warning" id="regenerateBtn">Regenerate Maze</button>
            <button class="btn btn-danger" id="resetBtn">Reset to Default</button>
          </div>
        </div>
      </div>
    </div>
    <!-- Maze Dimensions -->
    <div class="card mb-3">
      <div class="card-header" data-bs-toggle="collapse" data-bs-target="#collapseDimensions" aria-expanded="true" style="cursor:pointer;">
        Maze Dimensions
      </div>
      <div id="collapseDimensions" class="collapse show">
        <div class="card-body">
          <div class="mb-3">
            <label class="form-label"><strong>Width (in paths):</strong></label>
            <div class="number-input-group">
              <div class="number-btn number-btn-minus" onclick="decrementNumber('width')">−</div>
              <input class="form-control" step="5" min="10" max="100" value="20" type="number" data-for="width">
              <div class="number-btn number-btn-plus" onclick="incrementNumber('width')">+</div>
            </div>
          </div>
          <div class="mb-3">
            <label class="form-label"><strong>Height (in paths):</strong></label>
            <div class="number-input-group">
              <div class="number-btn number-btn-minus" onclick="decrementNumber('height')">−</div>
              <input class="form-control" step="5" min="10" max="100" value="20" type="number" data-for="height">
              <div class="number-btn number-btn-plus" onclick="incrementNumber('height')">+</div>
            </div>
          </div>
          <div class="mb-3">
            <label class="form-label"><strong>Levels:</strong></label>
            <div class="number-input-group">
              <div class="number-btn number-btn-minus" onclick="decrementNumber('levels')">−</div>
              <input class="form-control" min="1" max="20" value="3" type="number" data-for="levels">
              <div class="number-btn number-btn-plus" onclick="incrementNumber('levels')">+</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Wall & Path Settings -->
    <div class="card mb-3">
      <div class="card-header" data-bs-toggle="collapse" data-bs-target="#collapseWallPath" aria-expanded="false" style="cursor:pointer;">
        Wall & Path Settings
      </div>
      <div id="collapseWallPath" class="collapse">
        <div class="card-body">
          <div class="mb-3">
            <label class="form-label"><strong>Wall Width:</strong></label>
            <div class="number-input-group">
              <div class="number-btn number-btn-minus" onclick="decrementNumber('wallSize')">−</div>
              <input class="form-control" min="1" max="5" value="1" type="number" data-for="wallSize">
              <div class="number-btn number-btn-plus" onclick="incrementNumber('wallSize')">+</div>
            </div>
          </div>
          <div class="mb-3">
            <label class="form-label"><strong>Wall Height:</strong></label>
            <div class="number-input-group">
              <div class="number-btn number-btn-minus" onclick="decrementNumber('wallHeight')">−</div>
              <input class="form-control" min="1" max="50" value="3" type="number" data-for="wallHeight">
              <div class="number-btn number-btn-plus" onclick="incrementNumber('wallHeight')">+</div>
            </div>
          </div>
          <div class="mb-3">
            <label class="form-label"><strong>Path Width:</strong></label>
            <div class="number-input-group">
              <div class="number-btn number-btn-minus" onclick="decrementNumber('walkSize')">−</div>
              <input class="form-control" min="1" max="5" value="1" type="number" data-for="walkSize">
              <div class="number-btn number-btn-plus" onclick="incrementNumber('walkSize')">+</div>
            </div>
          </div>
          <div class="mb-3">
            <label class="form-label"><strong>Wall Block:</strong></label>
            <input class="form-control" value="stone" data-for="block">
          </div>
          <div class="form-check mb-2">
            <input class="form-check-input" type="checkbox" data-for="addRoof" id="addRoof">
            <label class="form-check-label" for="addRoof">
              Add ceiling to top level of maze
            </label>
          </div>
        </div>
      </div>
    </div>
    <!-- Holes & Ladders Settings -->
    <div class="card mb-3">
      <div class="card-header" data-bs-toggle="collapse" data-bs-target="#collapseHolesLadders" aria-expanded="false" style="cursor:pointer;">
        Holes & Ladders Settings
      </div>
      <div id="collapseHolesLadders" class="collapse">
        <div class="card-body">
          <div class="form-check mb-2">
            <input class="form-check-input" type="checkbox" data-for="generateHoles" checked id="generateHoles">
            <label class="form-check-label" for="generateHoles">
              Generate holes
            </label>
          </div>
          <div class="mb-3" id="holesPerLevelField">
            <label class="form-label">Number of holes per level</label>
            <div class="number-input-group">
              <div class="number-btn number-btn-minus" onclick="decrementNumber('holesPerLevel')">−</div>
              <input class="form-control" type="number" min="1" max="100" value="1" data-for="holesPerLevel">
              <div class="number-btn number-btn-plus" onclick="incrementNumber('holesPerLevel')">+</div>
            </div>
          </div>
          <div class="form-check mb-2">
            <input class="form-check-input" type="checkbox" data-for="generateLadders" checked id="generateLadders">
            <label class="form-check-label" for="generateLadders">
              Generate ladders for holes
            </label>
          </div>
        </div>
      </div>
    </div>
    <!-- File Export Options -->
    <div class="card mb-3">
      <div class="card-header" data-bs-toggle="collapse" data-bs-target="#collapseFileExport" aria-expanded="true" style="cursor:pointer;">
        File Export Options
      </div>
      <div id="collapseFileExport" class="collapse show">
        <div class="card-body">
          <div class="form-check mb-2">
            <input class="form-check-input" type="radio" name="naming" value="simple" checked id="simpleNaming">
            <label class="form-check-label" for="simpleNaming">
              Simple: 'maze.mcfunction'
            </label>
          </div>
          <div class="form-check mb-2">
            <input class="form-check-input" type="radio" name="naming" value="detailed" id="detailedNaming">
            <label class="form-check-label" for="detailedNaming">
              Detailed: <span data-show="detailed-name">20x20maze-ww2wh4pw2wbstone.mcfunction</span>
            </label>
          </div>
          <div class="form-check mb-2">
            <input class="form-check-input" type="radio" name="naming" value="custom" id="customNaming">
            <label class="form-check-label" for="customNaming">
              Custom Name
            </label>
          </div>
          <input class="form-control mb-2" placeholder="Enter a custom name" id="customNameInput" data-for="customName" style="display:none;">
          <div class="form-text" id="customNamePreview" style="display:none;">Preview: <span id="customNameText"></span>.mcfunction</div>
          <div class="d-grid gap-2 mt-3">
            <button class="btn btn-primary" id="downloadBtn">Download mcfunction file</button>
          </div>
        </div>
      </div>
    </div>
    <!-- Visual Aids -->
    <div class="card mb-3">
      <div class="card-header" data-bs-toggle="collapse" data-bs-target="#collapseVisualAids" aria-expanded="false" style="cursor:pointer;">
        Visual Aids
      </div>
      <div id="collapseVisualAids" class="collapse">
        <div class="card-body">
          <div class="form-check mb-2">
            <input class="form-check-input" type="checkbox" data-for="showBlockLegend" checked id="showBlockLegend">
            <label class="form-check-label" for="showBlockLegend">
              Show Block Legend
            </label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="checkbox" data-for="showChunkBorders" id="showChunkBorders">
            <label class="form-check-label" for="showChunkBorders">
              Show chunk borders
            </label>
          </div>
        </div>
      </div>
    </div>
    <!-- Credits -->
    <div class="card mb-3">
      <div class="card-header" data-bs-toggle="collapse" data-bs-target="#collapseCredits" aria-expanded="true" style="cursor:pointer;">
        Credits
      </div>
      <div id="collapseCredits" class="collapse show">
        <div class="card-body">
          <div class="small">
            <p><strong>Bibliofile</strong> - For the original codebase I forked and built on top of. Their work provided the foundation for the maze generation logic, TypeScript implementation, and the basic UI structure that I've enhanced and extended.<br>
            <a href="https://github.com/Bibliofile/MinecraftMazeGenerator" target="_blank">github.com/Bibliofile/MinecraftMazeGenerator</a></p>
            
            <p><strong>Jamis Buck</strong> - For the maze generator example and inspiration. His work on maze algorithms, particularly the Growing Tree algorithm, provided the theoretical foundation and implementation ideas that influenced the maze generation approach used in this project. His blog posts and examples were instrumental in understanding maze generation techniques.<br>
            <a href="https://weblog.jamisbuck.org/" target="_blank">weblog.jamisbuck.org</a><br>
            <a href="https://jamisbuck.org/mazes/minecraft.html#" target="_blank">Minecraft Maze Generator</a><br>
            <a href="https://weblog.jamisbuck.org/2011/1/27/maze-generation-growing-tree-algorithm" target="_blank">Growing Tree Algorithm</a></p>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Main Content -->
  <div class="main-content" id="mainContent">
    <div class="container-fluid py-4">
      <div class="text-center mb-5">
        <h1 class="display-1 text-primary">Minecraft Maze Generator</h1>
        <p class="lead text-muted">Create multi-level mazes for your Bedrock Edition worlds</p>
      </div>
        <div class="maze-container" style="display: flex; gap: 20px; margin-top: 20px;">          
          <div class="maze-display" style="flex: 1; text-align: center;">
            <!-- Block legend placeholder -->
            <div id="blockLegend" class="mb-3"></div>
            <nav aria-label="Level navigation">
              <ul class="pagination justify-content-center mb-3" id="levelPagination">
                <li class="page-item">
                  <a class="page-link" href="#" aria-label="Previous" id="prevBtn">
                    <span aria-hidden="true">&laquo;</span>
                  </a>
                </li>
                <!-- Level pages will be dynamically inserted here -->
                <li class="page-item">
                  <a class="page-link" href="#" aria-label="Next" id="nextBtn">
                    <span aria-hidden="true">&raquo;</span>
                  </a>
                </li>
              </ul>
            </nav>
            
            <div class="display-toggle mb-3">
              <button class="btn btn-sm btn-primary active" id="schematicBtn">Schematic View</button>
              <button class="btn btn-sm btn-outline-primary" id="exactBtn">Exact Block Layout</button>
            </div>
            
            <div style="position: relative; display: inline-block;">
              <div id="compassContainer" style="position: absolute; left: -250px; top: -200px; z-index: 20; width: 250px; height: 250px;">
                <svg width="250" height="250" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
                  <line x1="100" y1="20" x2="100" y2="180" stroke="black" stroke-width="2"/>
                  <line x1="20" y1="100" x2="180" y2="100" stroke="black" stroke-width="2"/>
                  <polygon points="95,25 105,25 100,15" fill="black"/>
                  <polygon points="95,175 105,175 100,185" fill="black"/>
                  <polygon points="25,95 25,105 15,100" fill="black"/>
                  <polygon points="175,95 175,105 185,100" fill="black"/>
                  <text x="100" y="10" font-size="12" text-anchor="middle">N (-Z)</text>
                  <text x="100" y="195" font-size="12" text-anchor="middle">S (+Z)</text>
                  <text x="0" y="95" font-size="12" text-anchor="start">W (-X)</text>
                  <text x="200" y="95" font-size="12" text-anchor="end">E (+X)</text>
                </svg>
              </div>
              <div id="mazeDisplay" style="display: flex; align-items: center; justify-content: center; min-height: 400px; padding: 20px; position: relative;"></div>
            </div>
            
            <div id="legend" class="legend" style="margin-top: 20px; display: flex; justify-content: center; gap: 20px;">
              <!-- Schematic view legend -->
              <div id="schematic-legend">
                <div class="legend-item" style="display: flex; align-items: center; gap: 5px;">
                  <div class="legend-color yellow" style="width: 20px; height: 20px; border: 1px solid #666; background: #ffff00;"></div>
                  <span>Hole + Ladder (Up) - Solid Wall</span>
                </div>
                <div class="legend-item" style="display: flex; align-items: center; gap: 5px;">
                  <div class="legend-color blue" style="width: 20px; height: 20px; border: 1px solid #666; background: #87ceeb;"></div>
                  <span>Hole + Ladder (Down) - Solid Wall</span>
                </div>
                <div class="legend-item" style="display: flex; align-items: center; gap: 5px;">
                  <div class="legend-color" style="width: 20px; height: 20px; border: 2px solid #4682b4; background: #87ceeb;"></div>
                  <span>Ladder - Corner Placement</span>
                </div>
                <div class="legend-item" style="display: flex; align-items: center; gap: 5px;">
                  <div class="legend-color" style="width: 20px; height: 20px; border: 2px solid #32cd32; background: #98fb98;"></div>
                  <span>Ladder - Wall Creation</span>
                </div>
                <div class="legend-item" style="display: flex; align-items: center; gap: 5px;">
                  <div class="legend-color" style="width: 20px; height: 20px; border: 2px solid #9932cc; background: #dda0dd;"></div>
                  <span>Ladder - Ceiling Mount</span>
                </div>
                <div class="legend-item" style="display: flex; align-items: center; gap: 5px;">
                  <div class="legend-color red" style="width: 20px; height: 20px; border: 1px solid #666; background: #ffaaaa;"></div>
                  <span>Hole Only (Up)</span>
                </div>
                <div class="legend-item" style="display: flex; align-items: center; gap: 5px;">
                  <div class="legend-color purple" style="width: 20px; height: 20px; border: 1px solid #666; background: #aaaaff;"></div>
                  <span>Hole Only (Down)</span>
                </div>
              </div>
              
              <!-- Exact block layout legend -->
              <div id="exact-legend">
                <div class="legend-item" style="display: flex; align-items: center; gap: 5px;">
                  <div class="legend-color" style="width: 20px; height: 20px; border: 1px solid #666; background: white;"></div>
                  <span>Path</span>
                </div>
                <div class="legend-item" style="display: flex; align-items: center; gap: 5px;">
                  <div class="legend-color" style="width: 20px; height: 20px; border: 1px solid #666; background: #777;"></div>
                  <span>Wall</span>
                </div>
                <div class="legend-item" style="display: flex; align-items: center; gap: 5px;">
                  <div class="legend-color" style="width: 20px; height: 20px; border: 1px solid #666; background: #90EE90;"></div>
                  <span>Entrance</span>
                </div>
                <div class="legend-item" style="display: flex; align-items: center; gap: 5px;">
                  <div class="legend-color" style="width: 20px; height: 20px; border: 1px solid #666; background: #FFB6C1;"></div>
                  <span>Exit</span>
                </div>
                <div class="legend-item" style="display: flex; align-items: center; gap: 5px;">
                  <div class="legend-color" style="width: 20px; height: 20px; border: 1px solid #666; background: #ffff00;"></div>
                  <span>Hole + Ladder</span>
                </div>
              </div>
            </div>
            <div id="legend-note" style="margin-top: 10px; font-size: 12px; color: #666; text-align: center;">
              <strong>Note:</strong> Indicators show hole locations (center of cells). Ladders are placed on adjacent walls.
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <script>
    // Sidebar Toggle Functionality
    document.addEventListener('DOMContentLoaded', function() {
      const sidebarToggle = document.getElementById('sidebarToggle');
      const sidebarContainer = document.getElementById('sidebarContainer');
      const sidebarOverlay = document.getElementById('sidebarOverlay');
      const mainContent = document.getElementById('mainContent');
      
      let sidebarOpen = true;
      
      function toggleSidebar() {
        sidebarOpen = !sidebarOpen;
        
        if (sidebarOpen) {
          sidebarContainer.classList.remove('collapsed');
          mainContent.classList.remove('expanded');
          sidebarToggle.classList.remove('active');
          sidebarOverlay.classList.remove('show');
        } else {
          sidebarContainer.classList.add('collapsed');
          mainContent.classList.add('expanded');
          sidebarToggle.classList.add('active');
          
          // Show overlay on mobile
          if (window.innerWidth <= 992) {
            sidebarOverlay.classList.add('show');
          }
        }
      }
      
      sidebarToggle.addEventListener('click', toggleSidebar);
      sidebarOverlay.addEventListener('click', function() {
        if (window.innerWidth <= 992) {
          toggleSidebar();
        }
      });
      
      // Handle window resize
      window.addEventListener('resize', function() {
        if (window.innerWidth > 992) {
          sidebarOverlay.classList.remove('show');
        } else if (!sidebarOpen) {
          sidebarOverlay.classList.add('show');
        }
      });

      // --- File Export Options: Custom Name Logic ---
      const simpleRadio = document.getElementById('simpleNaming');
      const detailedRadio = document.getElementById('detailedNaming');
      const customRadio = document.getElementById('customNaming');
      const customNameInput = document.getElementById('customNameInput');
      const customNamePreview = document.getElementById('customNamePreview');
      const customNameText = document.getElementById('customNameText');
      
      function updateCustomNameVisibility() {
        if (customRadio && customRadio.checked) {
          if (customNameInput) customNameInput.style.display = 'block';
          if (customNamePreview) customNamePreview.style.display = 'block';
          // Focus the input when it becomes visible
          if (customNameInput) setTimeout(() => customNameInput.focus(), 100);
        } else {
          if (customNameInput) customNameInput.style.display = 'none';
          if (customNamePreview) customNamePreview.style.display = 'none';
        }
      }
      
      function updateCustomNamePreview() {
        if (!customNameInput || !customNameText) return;
        const value = customNameInput.value.trim();
        customNameText.textContent = value || 'maze';
      }
      
      if (simpleRadio && detailedRadio && customRadio && customNameInput && customNamePreview && customNameText) {
        simpleRadio.addEventListener('change', updateCustomNameVisibility);
        detailedRadio.addEventListener('change', updateCustomNameVisibility);
        customRadio.addEventListener('change', updateCustomNameVisibility);
        
        // Multiple event types to ensure preview updates
        customNameInput.addEventListener('input', updateCustomNamePreview);
        customNameInput.addEventListener('keyup', updateCustomNamePreview);
        customNameInput.addEventListener('paste', () => setTimeout(updateCustomNamePreview, 10));
        customNameInput.addEventListener('change', updateCustomNamePreview);
        
        // Initial state
        updateCustomNameVisibility();
        updateCustomNamePreview();
      }
      
      // --- Custom Number Input Controls ---
      window.incrementNumber = function(fieldName) {
        const input = document.querySelector(`input[data-for="${fieldName}"]`);
        if (!input) return;
        
        const current = parseInt(input.value) || 0;
        const max = parseInt(input.getAttribute('max')) || Number.MAX_SAFE_INTEGER;
        const step = parseInt(input.getAttribute('step')) || 1;
        
        if (current + step <= max) {
          input.value = current + step;
          // Trigger input event to update the maze
          input.dispatchEvent(new Event('input', { bubbles: true }));
          updateButtonStates(fieldName);
        }
      }
      
      window.decrementNumber = function(fieldName) {
        const input = document.querySelector(`input[data-for="${fieldName}"]`);
        if (!input) return;
        
        const current = parseInt(input.value) || 0;
        const min = parseInt(input.getAttribute('min')) || Number.MIN_SAFE_INTEGER;
        const step = parseInt(input.getAttribute('step')) || 1;
        
        if (current - step >= min) {
          input.value = current - step;
          // Trigger input event to update the maze
          input.dispatchEvent(new Event('input', { bubbles: true }));
          updateButtonStates(fieldName);
        }
      }
      
      function updateButtonStates(fieldName) {
        const input = document.querySelector(`input[data-for="${fieldName}"]`);
        if (!input) return;
        
        const current = parseInt(input.value) || 0;
        const min = parseInt(input.getAttribute('min')) || Number.MIN_SAFE_INTEGER;
        const max = parseInt(input.getAttribute('max')) || Number.MAX_SAFE_INTEGER;
        const step = parseInt(input.getAttribute('step')) || 1;
        
        const inputGroup = input.closest('.number-input-group');
        if (!inputGroup) return;
        
        const minusBtn = inputGroup.querySelector('.number-btn-minus');
        const plusBtn = inputGroup.querySelector('.number-btn-plus');
        
        // Update minus button state
        if (minusBtn) {
          if (current - step < min) {
            minusBtn.classList.add('disabled');
          } else {
            minusBtn.classList.remove('disabled');
          }
        }
        
        // Update plus button state
        if (plusBtn) {
          if (current + step > max) {
            plusBtn.classList.add('disabled');
          } else {
            plusBtn.classList.remove('disabled');
          }
        }
      }
      
      // Initialize button states for all number inputs
      const numberInputs = document.querySelectorAll('input[type="number"][data-for]');
      numberInputs.forEach(input => {
        const fieldName = input.getAttribute('data-for');
        updateButtonStates(fieldName);
        
        // Update button states when input value changes
        input.addEventListener('input', () => updateButtonStates(fieldName));
      });
      
      // --- Reset to Default Button ---
      const resetBtn = document.getElementById('resetBtn');
      if (resetBtn) {
        resetBtn.addEventListener('click', function() {
          // Show confirmation dialog
          if (confirm('Are you sure you want to reset all settings to default values? This will refresh the page and all changes will be lost.')) {
            location.reload();
          }
        });
      }
      
      // --- Show/Hide All Toggle Button ---
      const toggleAllBtn = document.getElementById('toggleAllBtn');
      if (toggleAllBtn) {
        let allExpanded = false; // Track current state
        
        // Define which cards to always keep visible when hiding
        const alwaysVisible = ['collapseFileExport', 'collapseCredits'];
        
        // Define all collapsible cards
        const allCards = [
          'collapseGenBtns',
          'collapseDimensions', 
          'collapseWallPath',
          'collapseHolesLadders',
          'collapseFileExport',
          'collapseVisualAids',
          'collapseCredits'
        ];
        
        toggleAllBtn.addEventListener('click', function() {
          if (allExpanded) {
            // Hide All - collapse all except alwaysVisible
            allCards.forEach(cardId => {
              if (!alwaysVisible.includes(cardId)) {
                const collapse = document.getElementById(cardId);
                const header = document.querySelector(`[data-bs-target="#${cardId}"]`);
                if (collapse && header) {
                  // Use Bootstrap's collapse API to hide
                  const bsCollapse = new bootstrap.Collapse(collapse, { toggle: false });
                  bsCollapse.hide();
                  header.setAttribute('aria-expanded', 'false');
                }
              }
            });
            toggleAllBtn.textContent = 'Show All';
            allExpanded = false;
          } else {
            // Show All - expand all cards
            allCards.forEach(cardId => {
              const collapse = document.getElementById(cardId);
              const header = document.querySelector(`[data-bs-target="#${cardId}"]`);
              if (collapse && header) {
                // Use Bootstrap's collapse API to show
                const bsCollapse = new bootstrap.Collapse(collapse, { toggle: false });
                bsCollapse.show();
                header.setAttribute('aria-expanded', 'true');
              }
            });
            toggleAllBtn.textContent = 'Hide All';
            allExpanded = true;
          }
        });
      }
    });
  </script>
  
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js" integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q" crossorigin="anonymous"></script>
</body>

</html>

