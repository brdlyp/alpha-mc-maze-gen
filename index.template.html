<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.6.2/css/bulma.min.css">
  <title>Maze Generator</title>
  <script defer src="bundle.js"></script>
  <style>
    canvas {
      width: 100%;
      image-rendering: pixelated;
    }
    
    .tree-item {
      cursor: pointer;
      padding: 5px 10px;
      margin: 2px 0;
      border-radius: 3px;
      transition: background-color 0.2s;
    }
    
    .tree-item:hover {
      background-color: #e8e8e8;
    }
    
    .tree-item.active {
      background-color: #3273dc;
      color: white;
    }
    
    .maze-grid {
      display: inline-block;
      border: 2px solid #333;
      background: #333;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      border-radius: 4px;
    }
    
    .maze-container {
      display: flex;
      gap: 20px;
      margin-top: 20px;
      min-height: 600px;
    }
    
    .maze-row {
      display: flex;
      height: auto;
    }
    
    .maze-cell {
      width: 20px;
      height: 20px;
      border: 1px solid #666;
      position: relative;
      flex-shrink: 0;
      box-sizing: border-box;
      display: inline-block;
    }
    
    .maze-indicator {
      width: 20px;
      height: 10px;
    }
    
    /* Remove media queries - let JavaScript handle dynamic sizing */
    
    .maze-cell.wall {
      background: #777;
      border: 1px solid #aaa;
    }
    
    .maze-cell.path {
      background: white;
      border: 1px solid #ddd;
    }
    
    .maze-indicator.horizontal {
      background: white;
    }
    
    .maze-indicator.up {
      background: #ff7;
    }
    
    .maze-indicator.down {
      background: #7ff;
    }
    
    /* Exact block layout styles */
    .exact-maze-cell {
      width: 20px;
      height: 20px;
      border: 1px solid #666;
      box-sizing: border-box;
      flex-shrink: 0;
    }
    
    .exact-path {
      background: white;
    }
    
    .exact-border-wall {
      background: #555;
    }
    
    .exact-vertical-wall {
      background: #777;
    }
    
    .exact-horizontal-wall {
      background: #777;
    }
    
    .exact-wall-pillar {
      background: #999;
    }
    
    .exact-entrance {
      background: #90EE90;
    }
    
    .exact-exit {
      background: #FFB6C1;
    }
    
    .exact-hole-up-ladder {
      background: #ffff00;
    }
    
    .exact-hole-down-ladder {
      background: #87ceeb;
    }
    
    .exact-hole-up-only {
      background: #ffaaaa;
    }
    
    .exact-hole-down-only {
      background: #aaaaff;
    }
    
    .exact-unknown {
      background: #ff0000;
    }
    
    /* Enhanced ladder placement indicators */
    .ladder-solid-wall {
      background: #ffff00;
      border: 2px solid #ffaa00;
    }
    
    .ladder-corner {
      background: #87ceeb;
      border: 2px solid #4682b4;
    }
    
    .ladder-wall-creation {
      background: #98fb98;
      border: 2px solid #32cd32;
    }
    
    .ladder-ceiling {
      background: #dda0dd;
      border: 2px solid #9932cc;
    }
    
    /* Tooltip styles */
    .cell-tooltip {
      position: absolute;
      background: rgba(0, 0, 0, 0.9);
      color: white;
      padding: 8px 12px;
      border-radius: 4px;
      font-size: 12px;
      z-index: 1000;
      pointer-events: none;
      white-space: nowrap;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
      max-width: 250px;
    }
    
    .cell-tooltip::after {
      content: '';
      position: absolute;
      top: 100%;
      left: 50%;
      margin-left: -5px;
      border-width: 5px;
      border-style: solid;
      border-color: rgba(0, 0, 0, 0.9) transparent transparent transparent;
    }
    
    .display-toggle {
      margin-bottom: 15px;
    }
    
    .display-toggle button {
      margin-right: 10px;
    }
    
    .display-toggle button.active {
      background-color: #3273dc;
      color: white;
    }
  </style>
</head>

<body>
    <section class="section">
    <div class="has-text-centered mb-6">
      <h1 class="title is-1 has-text-primary">Minecraft Maze Generator</h1>
      <p class="subtitle is-5 has-text-grey">Create multi-level mazes for your Bedrock Edition worlds</p>
    </div>
    
    <div class="columns">
      <div class="column is-3">
        <div class="box content">
          <strong>Width (in paths):</strong>
          <input class="input" step="5" min="10" max="100" value="20" type="number" data-for="width">
          <strong>Height (in paths):</strong>
          <input class="input" step="5" min="10" max="100" value="20" type="number" data-for="height">
          <strong>Levels:</strong>
          <input class="input" min="1" max="20" value="3" type="number" data-for="levels">
          <strong>Dimensions (blocks):</strong>
          <span data-show="dimensions"></span>
        </div>
        <div class="box content">
          <strong>Wall width:</strong>
          <input class="input" min="1" max="5" value="1" type="number" data-for="wallSize">
          <strong>Wall height:</strong>
          <input class="input" min="1" max="50" value="3" type="number" data-for="wallHeight">
          <strong>Path width:</strong>
          <input class="input" min="1" max="5" value="1" type="number" data-for="walkSize">
          <strong>Wall block:</strong>
          <input class="input is-fullwidth" value="stone" data-for="block">
          <label class="checkbox" style="margin-top: 10px; display: block;">
            <input type="checkbox" data-for="addRoof"> Add ceiling/roof on top of maze
          </label>
        </div>
        <!-- Maze Options (new) -->
        <div class="box content">
          <strong>Maze Generation Mode:</strong>
          <div class="field" style="margin-top: 10px;">
            <label class="radio">
              <input type="radio" name="mazeGenerationMode" value="2D" data-for="mazeGenerationMode">
              2D Maze Generation - Each level is a complete, independent maze
            </label>
          </div>
          <div class="field">
            <label class="radio">
              <input type="radio" name="mazeGenerationMode" value="3D" data-for="mazeGenerationMode" checked>
              3D Maze Generation - Connected multi-level maze (may have walled-off areas)
            </label>
          </div>
          <div id="holeOptionsWrapper">
            <label class="checkbox" id="generateHolesLabel" style="margin-top: 10px;">
              <input type="checkbox" data-for="generateHoles" checked>
              Generate holes between levels
            </label>
            <div class="field" style="margin-top: 10px;" id="holesPerLevelField">
              <label class="label">Number of holes per level</label>
              <div class="control">
                <input class="input" type="number" min="1" max="100" value="1" data-for="holesPerLevel">
              </div>
            </div>
            <label class="checkbox" style="margin-top: 10px;">
              <input type="checkbox" data-for="generateLadders" checked>
              Generate ladders for holes
            </label>
          </div>
          <!-- 3D Maze Ladder Control -->
          <div id="ladder3DControl" style="display: none;">
            <label class="checkbox" style="margin-top: 10px;">
              <input type="checkbox" data-for="generateLadders3D" checked>
              Generate ladders for 3D maze (all vertical passages)
            </label>
          </div>
          <div id="holeOptionsNote" style="display:none; color:#888; font-size:13px; margin-top:10px;">
            In 3D Maze mode, all vertical passages are determined by the maze algorithm for full connectivity. Manual hole selection is disabled.
          </div>
        </div>
        <!-- End Maze Options -->
        <div class="box content">
          <strong>File naming options:</strong>
          <div class="field">
            <label class="radio">
              <input type="radio" name="naming" value="simple" checked>
              Simple: maze.mcfunction
            </label>
          </div>
          <div class="field">
            <label class="radio">
              <input type="radio" name="naming" value="detailed">
              Detailed: <span data-show="detailed-name">20x20maze-ww2wh4pw2wbstone.mcfunction</span>
            </label>
          </div>
          <div class="field">
            <label class="radio">
              <input type="radio" name="naming" value="custom">
              Custom name:
            </label>
            <input class="input" placeholder="Enter custom name" data-for="customName">
            <p class="help" id="customNamePreview" style="display: none;">Preview: <span id="customNameText"></span>.mcfunction</p>
          </div>
        </div>
        <div class="box">
          <h4 class="title is-6">Visual Aids</h4>
          <label class="checkbox" style="display: block; margin-bottom: 8px;">
            <input type="checkbox" data-for="showBlockLegend" checked> Show Block Legend
          </label>
          <label class="checkbox" style="display: block;">
            <input type="checkbox" data-for="showChunkBorders"> Show Chunk Borders
          </label>
        </div>
        <div class="box">
          <div class="buttons">
            <button class="button is-info" onclick="refreshDisplay()">Refresh</button>
            <button class="button is-warning" onclick="regenerateMaze()">Regenerate</button>
            <button class="button is-primary">Download function</button>
          </div>
        </div>
        <div class="box">
          <p class="help">Version: {{VERSION}}</p>
        </div>
        <div class="box">
          <h4 class="title is-6">Credits</h4>
          <div class="content is-small">
            <p><strong>Bibliofile</strong> - For the original codebase I forked and built on top of. Their work provided the foundation for the maze generation logic, TypeScript implementation, and the basic UI structure that I've enhanced and extended.<br>
            <a href="https://github.com/Bibliofile/MinecraftMazeGenerator" target="_blank">github.com/Bibliofile/MinecraftMazeGenerator</a></p>
            
            <p><strong>Jamis Buck</strong> - For the maze generator example and inspiration. His work on maze algorithms, particularly the Growing Tree algorithm, provided the theoretical foundation and implementation ideas that influenced the maze generation approach used in this project. His blog posts and examples were instrumental in understanding maze generation techniques.<br>
            <a href="https://weblog.jamisbuck.org/" target="_blank">weblog.jamisbuck.org</a><br>
            <a href="https://jamisbuck.org/mazes/minecraft.html#" target="_blank">Minecraft Maze Generator</a><br>
            <a href="https://weblog.jamisbuck.org/2011/1/27/maze-generation-growing-tree-algorithm" target="_blank">Growing Tree Algorithm</a></p>
          </div>
        </div>
      </div>
      
      <div class="column is-9">
        <div class="maze-container" style="display: flex; gap: 20px; margin-top: 20px;">
          <div class="tree-view" style="width: 200px; background: #f5f5f5; padding: 15px; border-radius: 5px; max-height: 600px; overflow-y: auto; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
            <h4 class="title is-6">Levels</h4>
            <div id="treeView"></div>
          </div>
          
          <div class="maze-display" style="flex: 1; text-align: center;">
            <!-- Block legend placeholder -->
            <div id="blockLegend" style="margin-bottom: 10px;"></div>
            <div class="level-controls" style="margin-bottom: 15px;">
              <button class="button is-small" onclick="previousLevel()" id="prevBtn">← Previous</button>
              <span class="mx-3">Level <span id="currentLevel">1</span> of <span id="totalLevels">3</span></span>
              <button class="button is-small" onclick="nextLevel()" id="nextBtn">Next →</button>
            </div>
            
            <div class="display-toggle">
              <button class="button is-small active" onclick="switchDisplay('schematic')" id="schematicBtn">Schematic View</button>
              <button class="button is-small" onclick="switchDisplay('exact')" id="exactBtn">Exact Block Layout</button>
            </div>
            
            <div style="position: relative; display: inline-block;">
              <div id="compassContainer" style="position: absolute; left: -250px; top: -200px; z-index: 20; width: 250px; height: 250px;">
                <svg width="250" height="250" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
                  <line x1="100" y1="20" x2="100" y2="180" stroke="black" stroke-width="2"/>
                  <line x1="20" y1="100" x2="180" y2="100" stroke="black" stroke-width="2"/>
                  <polygon points="95,25 105,25 100,15" fill="black"/>
                  <polygon points="95,175 105,175 100,185" fill="black"/>
                  <polygon points="25,95 25,105 15,100" fill="black"/>
                  <polygon points="175,95 175,105 185,100" fill="black"/>
                  <text x="100" y="10" font-size="12" text-anchor="middle">N (-Z)</text>
                  <text x="100" y="195" font-size="12" text-anchor="middle">S (+Z)</text>
                  <text x="0" y="95" font-size="12" text-anchor="start">W (-X)</text>
                  <text x="200" y="95" font-size="12" text-anchor="end">E (+X)</text>
                </svg>
              </div>
              <div id="mazeDisplay" style="display: flex; align-items: center; justify-content: center; min-height: 400px; padding: 20px; position: relative;"></div>
            </div>
            
            <div id="legend" class="legend" style="margin-top: 20px; display: flex; justify-content: center; gap: 20px;">
              <!-- Schematic view legend -->
              <div id="schematic-legend">
                <div class="legend-item" style="display: flex; align-items: center; gap: 5px;">
                  <div class="legend-color yellow" style="width: 20px; height: 20px; border: 1px solid #666; background: #ffff00;"></div>
                  <span>Hole + Ladder (Up) - Solid Wall</span>
                </div>
                <div class="legend-item" style="display: flex; align-items: center; gap: 5px;">
                  <div class="legend-color blue" style="width: 20px; height: 20px; border: 1px solid #666; background: #87ceeb;"></div>
                  <span>Hole + Ladder (Down) - Solid Wall</span>
                </div>
                <div class="legend-item" style="display: flex; align-items: center; gap: 5px;">
                  <div class="legend-color" style="width: 20px; height: 20px; border: 2px solid #4682b4; background: #87ceeb;"></div>
                  <span>Ladder - Corner Placement</span>
                </div>
                <div class="legend-item" style="display: flex; align-items: center; gap: 5px;">
                  <div class="legend-color" style="width: 20px; height: 20px; border: 2px solid #32cd32; background: #98fb98;"></div>
                  <span>Ladder - Wall Creation</span>
                </div>
                <div class="legend-item" style="display: flex; align-items: center; gap: 5px;">
                  <div class="legend-color" style="width: 20px; height: 20px; border: 2px solid #9932cc; background: #dda0dd;"></div>
                  <span>Ladder - Ceiling Mount</span>
                </div>
                <div class="legend-item" style="display: flex; align-items: center; gap: 5px;">
                  <div class="legend-color red" style="width: 20px; height: 20px; border: 1px solid #666; background: #ffaaaa;"></div>
                  <span>Hole Only (Up)</span>
                </div>
                <div class="legend-item" style="display: flex; align-items: center; gap: 5px;">
                  <div class="legend-color purple" style="width: 20px; height: 20px; border: 1px solid #666; background: #aaaaff;"></div>
                  <span>Hole Only (Down)</span>
                </div>
              </div>
              
              <!-- Exact block layout legend -->
              <div id="exact-legend" style="display: none;">
                <div class="legend-item" style="display: flex; align-items: center; gap: 5px;">
                  <div class="legend-color" style="width: 20px; height: 20px; border: 1px solid #666; background: white;"></div>
                  <span>Path</span>
                </div>
                <div class="legend-item" style="display: flex; align-items: center; gap: 5px;">
                  <div class="legend-color" style="width: 20px; height: 20px; border: 1px solid #666; background: #777;"></div>
                  <span>Wall</span>
                </div>
                <div class="legend-item" style="display: flex; align-items: center; gap: 5px;">
                  <div class="legend-color" style="width: 20px; height: 20px; border: 1px solid #666; background: #90EE90;"></div>
                  <span>Entrance</span>
                </div>
                <div class="legend-item" style="display: flex; align-items: center; gap: 5px;">
                  <div class="legend-color" style="width: 20px; height: 20px; border: 1px solid #666; background: #FFB6C1;"></div>
                  <span>Exit</span>
                </div>
                <div class="legend-item" style="display: flex; align-items: center; gap: 5px;">
                  <div class="legend-color" style="width: 20px; height: 20px; border: 1px solid #666; background: #ffff00;"></div>
                  <span>Hole + Ladder</span>
                </div>
              </div>
            </div>
            <div id="legend-note" style="margin-top: 10px; font-size: 12px; color: #666; text-align: center;">
              <strong>Note:</strong> Indicators show hole locations (center of cells). Ladders are placed on adjacent walls.
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</body>

</html>
